# **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ RAG**

–î–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –Ω–æ—É—Ç–±—É–∫–∏, –ø–æ—Å–≤—è—â—ë–Ω–Ω—ã–µ **–¥–æ–æ–±—É—á–µ–Ω–∏—é** (fine-tuning) –∏ **–æ—Ü–µ–Ω–∫–µ** (evaluation) –º–æ–¥–µ–ª–µ–π –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –≤ Retrieval-Augmented Generation (**RAG**).

## **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**

üìÇ `fine-tuning/` ‚Äì —Ñ–∞–π–ª—ã –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π:

- `roberta_fine_tuning.ipynb` ‚Äì –¥–æ–æ–±—É—á–µ–Ω–∏–µ **RoBERTa** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∞–∫—Ç–æ–≤.
- `flan_t5_fine_tuning.ipynb` ‚Äì –¥–æ–æ–±—É—á–µ–Ω–∏–µ **FLAN-T5** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.

üìÇ `evaluation/` ‚Äì —Ñ–∞–π–ª—ã –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–µ–π:

- `baseline_evaluation.ipynb` ‚Äì –∞–Ω–∞–ª–∏–∑ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π –¥–æ –¥–æ–æ–±—É—á–µ–Ω–∏—è.
- `fine_tuned_evaluation.ipynb` ‚Äì –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π –ø–æ—Å–ª–µ –¥–æ–æ–±—É—á–µ–Ω–∏—è.

---

## **1. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤**

### **1.1. Fine-tuning (–¥–æ–æ–±—É—á–µ–Ω–∏–µ)**

–ó–∞–¥–∞—á–∞: —É–ª—É—á—à–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π **RoBERTa** –∏ **FLAN-T5**, –æ–±—É—á–∏–≤ –∏—Ö –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–∞–∫—Ç–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤ —Å —É—á—ë—Ç–æ–º retrieved context.

**üîπ RoBERTa (—Ñ–∞–∫—Ç—á–µ–∫–∏–Ω–≥)**

- **–ú–æ–¥–µ–ª—å**: `roberta-large-mnli`.
- **–î–∞—Ç–∞—Å–µ—Ç**: **FEVER** ([—Å—Å—ã–ª–∫–∞](https://fever.ai/data.html)), —Å–æ–¥–µ—Ä–∂–∏—Ç —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏–µ/–æ–ø—Ä–æ–≤–µ—Ä–≥–∞—é—â–∏–µ —Ñ–∞–∫—Ç—ã.
- **–ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è**:
  - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –Ω–∞ `SUPPORTS`, `REFUTES`, `NOT ENOUGH INFO`.
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **cross-entropy loss**.
  - –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä **AdamW**, `learning_rate = 2e-5`, `batch_size = 16`, `epochs = 3`.
  - –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

**üîπ FLAN-T5 (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤)**

- **–ú–æ–¥–µ–ª—å**: `google/flan-t5-base`.
- **–î–∞—Ç–∞—Å–µ—Ç**: **SQuAD v2** ([—Å—Å—ã–ª–∫–∞](https://rajpurkar.github.io/SQuAD-explorer/)) + **FEVER**.
- **–ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è**:
  - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ `question + retrieved context`.
  - Loss-—Ñ—É–Ω–∫—Ü–∏—è **cross-entropy** –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **beam search** –∏ **temperature scaling**.
  - –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä **AdamW**, `learning_rate = 3e-5`, `batch_size = 8`, `epochs = 1`.
  - –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ **validation loss** –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤.

---

### **1.2. Evaluation (–æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π)**

–ó–∞–¥–∞—á–∞: –∞–Ω–∞–ª–∏–∑ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π –∏ –≤–ª–∏—è–Ω–∏–µ retrieved context –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ—Ç–≤–µ—Ç–æ–≤.

**üîπ Baseline Evaluation (–¥–æ –¥–æ–æ–±—É—á–µ–Ω–∏—è)**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –º–æ–¥–µ–ª–µ–π **T5** –∏ **RoBERTa**.
- –ú–µ—Ç—Ä–∏–∫–∏: **accuracy, precision, recall, F1-score**.
- –ê–Ω–∞–ª–∏–∑ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ **–ª–æ–≥–∏—Ç—ã softmax**.
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `confidence vs self-assessment`.

**üîπ Fine-Tuned Evaluation (–ø–æ—Å–ª–µ –¥–æ–æ–±—É—á–µ–Ω–∏—è)**

- –ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.
- –ú–µ—Ç—Ä–∏–∫–∏: **BLEU, ROUGE, BERTScore** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –º–æ–¥–µ–ª–∏.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É—á–∞–µ–≤ **–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π** –º–æ–¥–µ–ª–∏.
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ fine-tuning.

---

## **2. –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Å—Ç–µ–∫**

### **2.1. LLM (–Ø–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏)**

- `roberta-large-mnli` –¥–ª—è —Ñ–∞–∫—Ç—á–µ–∫–∏–Ω–≥–∞.
- `google/flan-t5-base` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.

### **2.2. –î–∞—Ç–∞—Å–µ—Ç—ã**

- **FEVER** ([FEVER AI](https://fever.ai/data.html)) ‚Äì —Ñ–∞–∫—Ç—á–µ–∫–∏–Ω–≥.
- **SQuAD v2** ([SQuAD Explorer](https://rajpurkar.github.io/SQuAD-explorer/)) ‚Äì –≤–æ–ø—Ä–æ—Å–Ω–æ-–æ—Ç–≤–µ—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è.

### **2.3. Retrieval-Augmented Generation (RAG)**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Google Custom Search API** –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤:

- –ü–æ–ª—É—á–µ–Ω–∏–µ `top_k` —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∑–∞–ø—Ä–æ—Å—É.
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ `snippets` –∏–∑ –ø–µ—Ä–≤—ã—Ö `k` –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
- –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –ø–µ—Ä–µ–¥ –ø–æ–¥–∞—á–µ–π –≤ –º–æ–¥–µ–ª—å.

–ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞ API:

```python
from googleapiclient.discovery import build

def retrieve_context(query, top_k=5):
    service = build("customsearch", "v1", developerKey="YOUR_API_KEY")
    result = service.cse().list(q=query, cx="YOUR_CSE_ID", num=top_k).execute()
    snippets = [item["snippet"] for item in result.get("items", [])]
    return " ".join(snippets)
```

---

## **3. –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤**

### **3.1. –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**

–û—Ç–∫—Ä—ã—Ç—å –Ω–æ—É—Ç–±—É–∫ –≤ Google Colab, –∑–∞–ø—É—Å—Ç–∏—Ç—å —è—á–µ–π–∫–∏ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –∏ –∑–∞–ø—É—Å–∫–æ–º –æ–±—É—á–µ–Ω–∏—è:

```python
!python fine-tuning/roberta_fine_tuning.ipynb
```

```python
!python fine-tuning/flan_t5_fine_tuning.ipynb
```

### **3.2. –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π**

–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:

```python
!python evaluation/baseline_evaluation.ipynb
```

```python
!python evaluation/fine_tuned_evaluation.ipynb
```

---

## **4. –í—ã–≤–æ–¥—ã –∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã**

–ú–µ—Ç–æ–¥—ã –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ retrieved context –∏–∑ Google Search API –ø–æ–∑–≤–æ–ª—è—é—Ç:
‚úÖ –ü–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å —Ñ–∞–∫—Ç—á–µ–∫–∏–Ω–≥–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.
‚úÖ –°–Ω–∏–∑–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –≤ RAG-—Å–∏—Å—Ç–µ–º–µ.
‚úÖ –û—Ü–µ–Ω–∏—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π –∏ –µ—ë –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤.

**–î–∞–ª—å–Ω–µ–π—à–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è** –≤–∫–ª—é—á–∞—é—Ç:

- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é retrieved context (–Ω–∞–ø—Ä–∏–º–µ—Ä, reranking).
- –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π.
- –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π.
